## We’ll explore various aspects such as top-selling games, regional sales comparisons, and publisher performance over time.

## 1. Overview of the Data
## Let's start by examining the available data from two key tables:
## * VGsalesMetric: Contains metrics on video game sales including global and regional sales figures.
## * VGsalesInfo: Provides additional information about the games such as their genre, publisher, and rank.
## I will first show you the raw data from these tables to give you an overview of the dataset.
## Description
## This dataset contains a list of video games with sales greater than 100,000 copies. It was generated by a scrape of vgchartz.com.
## Fields include
## * Name - The games name
## * Platform - Platform of the games release (i.e. PC,PS4, etc.)
## * Year - Year of the game's release
## * Genre - Genre of the game
## * Publisher - Publisher of the game
## * NA_Sales - Sales in North America (in millions)
## * EU_Sales - Sales in Europe (in millions)
## * JP_Sales - Sales in Japan (in millions)
## * Other_Sales - Sales in the rest of the world (in millions)
##* Global_Sales - Total worldwide sales.


SELECT *
FROM `Portfolio_dataset.VGsalesMetric`;

SELECT *
FROM `Portfolio_dataset.VGsalesInfo`;

## 2. Top 10 Games by Rank
## To identify the top 10 games based on their rank, we’ll sort the games by their rank and limit our results to the top 10.

SELECT *
FROM `Portfolio_dataset.VGsalesMetric`
ORDER BY Rank ASC
LIMIT 10;

## 3. Top 20 Games in North America by Sales
## Next, let's focus on the top 20 games in North America based on sales. This will help us understand which games have been most popular in this region.

SELECT Rank, Name, Year, NA_Sales
FROM `Portfolio_dataset.VGsalesMetric`
ORDER BY NA_Sales DESC
LIMIT 20;

## 4. Regional Sales Comparison
## We will now look at the total sales by region to get a sense of how sales are distributed globally.

SELECT SUM(NA_Sales) AS NA, SUM(EU_Sales) AS EU, SUM(JP_Sales) AS JP, SUM(Other_Sales) AS Other, SUM(Global_Sales) AS GL
FROM `Portfolio_dataset.VGsalesMetric`;

## 5. Percentage of Global Sales by Region
## To understand each region’s contribution to global sales, we calculate the percentage of global sales contributed by each region.

SELECT (SUM(Global_Sales)/SUM(NA_Sales)) AS pNA, (SUM(Global_Sales)/SUM(EU_Sales)) AS pEU, (SUM(Global_Sales)/SUM(JP_Sales)) AS pJP, (SUM(Global_Sales)/SUM(Other_Sales)) AS pOther
FROM `Portfolio_dataset.VGsalesMetric`;

## 6. Merging Tables for Detailed Insights
## We will join VGsalesMetric with VGsalesInfo to enrich our data with additional game details like publisher and genre.

SELECT metric.rank, metric.name, metric.Global_Sales, info.publisher
FROM `Portfolio_dataset.VGsalesMetric` AS Metric
INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info
ON Metric.Rank = Info.rank
ORDER BY metric.rank 
LIMIT 5;

## 7. Top 10 Game Genres in North America
## Now, let’s analyze which game genres perform the best in North America.

SELECT Info.Genre,
       SUM(metric.NA_Sales) AS Total_North_America_Sales
FROM `Portfolio_dataset.VGsalesMetric` AS Metric
INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info
ON Metric.Rank = Info.rank
GROUP BY Info.Genre
ORDER BY Total_North_America_Sales DESC
LIMIT 10;

## 8. Top 10 Games in North America vs Japan
## We will compare the top 10 games in North America with their sales in Japan.

SELECT Info.Name,
       SUM(metric.NA_Sales) AS Total_North_America_Sales, 
       SUM(metric.JP_Sales) AS Total_Japan_Sales
FROM `Portfolio_dataset.VGsalesMetric` AS Metric
INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info
ON Metric.Rank = Info.rank
GROUP BY Info.Name
ORDER BY Total_North_America_Sales DESC
LIMIT 10;

## 9. Top 10 Global Sales Publishers
## To understand which publishers dominate global sales, we will identify the top 10 publishers based on their total global sales.

SELECT Info.Publisher, SUM(metric.Global_Sales) AS Total_Global_Sales
FROM `Portfolio_dataset.VGsalesMetric` AS Metric
INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info
ON Metric.Rank = Info.rank
GROUP BY Info.Publisher
ORDER BY Total_Global_Sales DESC
LIMIT 10;

## 10. Top 10 Publishers from 1995 to 2015
## Focusing on the period from 1995 to 2015, we’ll analyze the top publishers during these years.

SELECT Info.Publisher, SUM(metric.Global_Sales) AS Total_Global_Sales
FROM `Portfolio_dataset.VGsalesMetric` AS Metric
INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info
ON Metric.Rank = Info.rank
WHERE SAFE_CAST(metric.year AS INT64) BETWEEN 1995 AND 2015
  AND metric.year != 'N/A'  
GROUP BY Info.Publisher
ORDER BY Total_Global_Sales DESC
LIMIT 10;

## 11. Percentage of North American Sales in Global Market (1995-2015)
## We’ll now calculate the percentage of North American sales compared to global sales for publishers from 1995 to 2015.

SELECT Publisher,
       Total_Global_Sales,
       North_America_Sales,
       (North_America_Sales / Total_Global_Sales * 100 ) AS Percent_America_to_Global
FROM (
    SELECT Info.Publisher AS Publisher,
           SUM(metric.Global_Sales) AS Total_Global_Sales,
           SUM(Metric.NA_Sales) AS North_America_Sales
    FROM `Portfolio_dataset.VGsalesMetric` AS Metric
    INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info
    ON Metric.Rank = Info.rank
    WHERE SAFE_CAST(metric.year AS INT64) BETWEEN 1995 AND 2015
      AND metric.year != 'N/A'  
    GROUP BY Info.Publisher
)
ORDER BY Total_Global_Sales DESC
LIMIT 10;

## 12. Top 10 Games in North America with Sales Percentages and Comparison with Japan
## Finally, we’ll look at the top 10 games in North America, including their sales percentages and a comparison of North American sales to Japanese sales.

SELECT Info.Name,
       SUM(Metric.NA_Sales) AS Total_NA_Sales,
       (SUM(IFNULL(Metric.NA_Sales, 0)) / TotalSales.Total_Sum_NA_Sales ) * 100 AS NA_Sales_Percent_of_Total,
       SUM(Metric.JP_Sales) AS Total_JP_Sales,
       (SUM(IFNULL(Metric.JP_Sales, 0)) / TotalSales.Total_Sum_JP_Sales) * 100 AS JP_Sales_Percent_of_Total
FROM `Portfolio_dataset.VGsalesMetric` AS Metric
INNER JOIN `Portfolio_dataset.VGsalesInfo` AS Info ON Metric.Rank = Info.rank
CROSS JOIN (
    SELECT 
        SUM(IFNULL(Metric.NA_Sales, 0)) AS Total_Sum_NA_Sales,
        SUM(IFNULL(Metric.JP_Sales, 0)) AS Total_Sum_JP_Sales
    FROM `Portfolio_dataset.VGsalesMetric` AS Metric
) AS TotalSales
GROUP BY Info.Name, Total_Sum_NA_Sales, Total_Sum_JP_Sales
ORDER BY Total_NA_Sales DESC
LIMIT 10;

## Conclusion
## In summary, we’ve explored key insights into video game sales performance, from the top games and publishers to regional sales comparisons. 
## This analysis provides a comprehensive view of how different games and publishers perform across various regions, helping us understand market 
## trends and consumer preferences better.
